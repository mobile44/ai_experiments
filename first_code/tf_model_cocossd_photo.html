<html>
    <head><title>Local video playback</title></head>
    <!-- Import TensorFlow.js library -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js" type="text/javascript"></script>
    <!-- Import TensorFlow.js library -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs/dist/tf.min.js" type="text/javascript"></script>
    <!-- Load the coco-ssd model to use to recognize things in images -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
    <style>
        #camon {
            display: block;
        }
        #status {
            display: none;
        }
    </style>
    <body onload="countPeople()">
        <image id='jpg' src='./images/000000000769.jpg'>Persons</image>
        <input type="text" id="url" name="urlname"/>
        <button id="sendurl" onclick="getPicture()">Change Picture</button>
        <image id='webjpg' src='https://d2gg9evh47fn9z.cloudfront.net/800px_COLOURBOX4494862.jpg'>On line Image</image>
        <!--<video id="localVideo" autoplay playsinline controls="false"></video>-->
        <!--<button id="camon" onclick="stopCam()">Stop Camera</button>-->
        <!--<button id="status" onclick="reloadSite()">Reload</button>-->
        <script>
            function getPicture() {
                var urlimg = document.getElementById('url').value;
                console.log("URL:",urlimg);
                document.getElementById('jpg').src = urlimg;
                countPeople();
            }
            function filterByID(item) {
                if (item.class === "person") {
                    return true;    
                } 
                invalidEntries++
                return false;
            }
            function countPeople() {
                //document.getElementById('webimg').crossOrigin = "anonymous";
                const img = document.getElementById('webjpg');
                cocoSsd.load().then(model => {
                    // detect objects in the image.
                    model.detect(img).then(predictions => {
                        let arrByID = predictions.filter(filterByID);
                        //console.log("Person: ",arrByID.length);
                        //console.log('Predictions: ', predictions);
                        for (i=0; i<predictions.length; i++) {
                            console.log("Class:",predictions[i].class);
                        }
                    });
                });
            }
            /*
            var camon
            const constraints = {
                video: true,
            };
            const video = document.querySelector("video");
            navigator.mediaDevices.getUserMedia(constraints).then((stream) => {
                video.srcObject = stream;
            });
            const img = document.getElementById('jpg');
            // Load the model.
            cocoSsd.load().then(model => {
                // detect objects in the image.
                model.detect(img).then(predictions => {
                    let arrByID = predictions.filter(filterByID);
                    console.log("Person: ",arrByID.length);
                    console.log('Predictions: ', predictions);
                    for (i=0; i<predictions.length; i++) {
                        console.log("Class:",predictions[i].class);
                    }
                });
            });
            function stopCam() {
                video.pause();
                video.srcObject = null;               
                document.getElementById('camon').style.display="none";
                document.getElementById('status').style.display="block";
            }
            function reloadSite() {
                location.reload();
            }
            function filterByID(item) {
                if (item.class === "person") {
                    return true;    
                } 
                invalidEntries++
                return false;
            }
            */
        </script>
    </body>
</html>
